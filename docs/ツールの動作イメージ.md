# ツールの動作イメージ

タスク生成ツールに、業務を規定するプロンプトと、ターゲットリストを与える。なお、ターゲットリストは改行区切りで複数のエントリを記述する。

例えば、URLが記載されたターゲットリストを与えて、「URLリストのURLに一つずつアクセスして、ページの要約をresults/ディレクトリにマークダウン形式でファイル出力しなさい」という業務プロンプトを入力する。

タスク生成ツールは、ターゲットリストのURLごとにタスクプロンプトを書き出す。例えば、URLリストには、urlA、urlB、urlCが列挙されているとする。タスクプロンプトは、業務プロンプトとひとつのURLを組み合わせて以下のようにする。

```text
あなたは、有能なビジネスマンです。上司から、「ターゲットリストのURLに一つずつアクセスして、ページの要約をresults/ディレクトリにマークダウン形式でファイル出力しなさい」というミッションを与えられました。一緒に与えられたリストを複数のビジネスマンが分担して取り組みます。あなたが割り当てられたのは、urlAです。上司からの指示に従ってミッションを実行してください。
```

タスク生成ツールは、ターゲットリストの各行ごとに上記のようなプロンプトを生成し、.tasks/pending/ディレクトリにテキストファイルとして書き出す。



タスク生成ツールの動作が完了したあとは、操作者がタスク管理マスタを起動する。さらに、別ターミナルでタスクワーカーを起動する。

タスク管理マスタは、タスクワーカーに対して、.tasks/pending/の下にあるタスクプロンプトファイルを一つ指定して実行を依頼する。

タスクワーカーは、タスクマスタからの依頼を受けて、タスクを実行する。

タスクの実行が完了または失敗したら、タスク管理マスターに報告し、次の依頼を待つ。

タスク管理マスタは、.tasks/pending/のファイルがなくなるまで、ワーカーにタスクを依頼する。

全てのタスクプロンプトファイルが.tasks/pendingからなくなったら、タスク管理マスタはワーカーに終了通知を送り、自らも終了する。

ワーカーは、終了通知を受け取ると、依頼待受を解除して、自らも終了する。

